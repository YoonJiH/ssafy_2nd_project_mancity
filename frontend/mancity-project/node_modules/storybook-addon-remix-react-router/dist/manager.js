import { addons, types, useChannel, ManagerContext } from '@storybook/manager-api';
import p, { useState, useContext, useEffect, Fragment } from 'react';
import L from '../package.json' assert { type: 'json' };
import { ScrollArea, AddonPanel, ActionBar } from '@storybook/components';
import { STORY_CHANGED } from '@storybook/core-events';
import { compareVersions } from 'compare-versions';
import { styled, withTheme } from '@storybook/theming';
import { ObjectInspector } from 'react-inspector';

var a="storybook/react-router-v6",f=`${a}/panel`,A="reactRouter",o={CLEAR:`${a}/clear`,NAVIGATION:`${a}/navigation`,STORY_LOADED:`${a}/story-loaded`,ROUTE_MATCHES:`${a}/route-matches`,ACTION_INVOKED:`${a}/action_invoked`,ACTION_SETTLED:`${a}/action_settled`,LOADER_INVOKED:`${a}/loader_invoked`,LOADER_SETTLED:`${a}/loader_settled`},c=L.version;function l(){let[e,r]=useState();useEffect(()=>{if(e!==void 0)return;let i=new AbortController;return fetch("https://registry.npmjs.org/storybook-addon-remix-react-router/latest",{signal:i.signal}).then(t=>t.json()).then(t=>r(t.version)).catch(()=>{}),()=>i.abort()},[e]);let s=e===void 0?void 0:compareVersions(e,c)===1;return {currentAddonVersion:c,latestAddonVersion:e,addonUpdateAvailable:s}}var u=styled.p`
  background: #ffebba;
  padding: 5px;
  margin-top: 0;
`;var T=styled.div({flex:1,padding:"0 0 0 5px"});var O=styled.div({display:"flex",padding:0,borderLeft:"5px solid transparent",borderBottom:"1px solid transparent",transition:"all 0.1s",alignItems:"flex-start",whiteSpace:"pre"});var D=withTheme(({theme:e,...r})=>p.createElement(ObjectInspector,{theme:e.addonActionsTheme||"chromeLight",...r}));var W=ScrollArea,N=({routerEvents:e,onClear:r})=>p.createElement(Fragment,null,p.createElement(C,{title:"reactRouterLogger"},e.map((s,i)=>p.createElement(O,{key:i},p.createElement(T,null,p.createElement(D,{name:j[s.type],data:s.data,showNonenumerable:!1,sortObjectKeys:!1,expandPaths:["$.routeParams","$.searchParams","$.routeMatches.*","$.routeMatches.*.*","$.matches","$.matches.*","$.matches.*.*"]}))))),p.createElement(ActionBar,{actionItems:[{title:"Clear",onClick:r}]})),j={[o.NAVIGATION]:"Navigate",[o.STORY_LOADED]:"Story rendered",[o.ROUTE_MATCHES]:"New route matches",[o.ACTION_INVOKED]:"Action invoked",[o.ACTION_SETTLED]:"Action settled",[o.LOADER_INVOKED]:"Loader invoked",[o.LOADER_SETTLED]:"Loader settled"},C=styled(({children:e,title:r})=>p.createElement(W,{horizontal:!0,vertical:!0,title:r},e))({margin:0,padding:"10px 5px 20px"});C.displayName="Wrapper";var I=e=>{let[r,s]=useState([]),{latestAddonVersion:i,addonUpdateAvailable:t}=l(),n=E=>{s(P=>[...P,E]);};useChannel({[o.ROUTE_MATCHES]:n,[o.NAVIGATION]:n,[o.STORY_LOADED]:n,[o.ACTION_INVOKED]:n,[o.ACTION_SETTLED]:n,[o.LOADER_INVOKED]:n,[o.LOADER_SETTLED]:n,[STORY_CHANGED]:()=>s([])});let m=()=>{e.api.emit(o.CLEAR),s([]);};return p.createElement(AddonPanel,{...e},t&&p.createElement(u,null,"Version ",i," is now available !"," ",p.createElement("a",{href:`https://github.com/JesusTheHun/storybook-addon-remix-react-router/releases/tag/v${i}`},"Changelog"),"."),p.createElement(N,{routerEvents:r,onClear:m}))};function v(){let{api:e}=useContext(ManagerContext),{addonUpdateAvailable:r}=l(),[s,i]=useState(0),t=()=>i(E=>E+1),n=()=>i(0);useEffect(()=>(e.on(STORY_CHANGED,n),e.on(o.ROUTE_MATCHES,t),e.on(o.NAVIGATION,t),e.on(o.ACTION_INVOKED,t),e.on(o.ACTION_SETTLED,t),e.on(o.LOADER_INVOKED,t),e.on(o.LOADER_SETTLED,t),e.on(o.CLEAR,n),()=>{e.off(STORY_CHANGED,n),e.off(o.ROUTE_MATCHES,t),e.off(o.NAVIGATION,t),e.off(o.ACTION_INVOKED,t),e.off(o.ACTION_SETTLED,t),e.off(o.LOADER_INVOKED,t),e.off(o.LOADER_SETTLED,t),e.off(o.CLEAR,n);}),[e]);let m=[];return r&&m.push("\u26A1\uFE0F"),s&&m.push(`(${s})`),p.createElement(p.Fragment,null,"React Router ",m.join(" "))}addons.register(a,e=>{addons.add(f,{type:types.PANEL,paramKey:A,title:p.createElement(v,null),match:({viewMode:r})=>r==="story",render:({active:r})=>p.createElement(I,{active:r||!1,api:e,key:a})});});
//# sourceMappingURL=out.js.map
//# sourceMappingURL=manager.js.map